# 사용 가이드

## 🚀 시작하기

### 실행
```bash
python src/main.py
```

## 📖 기본 사용법

### 1. 액션 녹화
1. **⏺️ 녹화 (F9)** 버튼 클릭 또는 F9 키 누름
2. 마우스 클릭, 드래그, 키보드 입력 등 원하는 작업 수행
3. **⏹️ 중지 (F12)** 버튼 클릭 또는 F12 키 눌러 녹화 종료
4. 녹화된 액션이 타임라인에 자동으로 추가됨

### 2. 액션 수동 추가
1. 좌측 사이드바에서 원하는 액션 타입 선택
   - 🖱️ **마우스**: 클릭, 더블클릭, 드래그, 스크롤, 연타
   - ⌨️ **키보드**: 텍스트 입력, 단축키, 키 연타
   - ⏱️ **흐름 제어**: 대기, 이미지 조건, 루프
   - 🔧 **고급**: 변수, 이미지/색상 대기
2. 타임라인에 액션 추가됨
3. 우측 상세 패널에서 값 수정

### 3. 액션 재생
1. **▶️ 재생** 버튼 클릭
2. 액션이 순차적으로 실행됨
3. **⏹️ 중지 (F12)** 로 언제든지 중단 가능

### 4. 프로젝트 저장/로드
- 저장: `파일 > 저장` 또는 Ctrl+S
- 로드: `파일 > 열기` 또는 Ctrl+O
- 저장 위치: `~/.automacro/projects/`

## 🎯 고급 기능

### 이미지 인식
1. 좌측에서 **이미지 조건** 액션 추가
2. 우측 패널에서 **이미지 선택** 버튼 클릭
3. 화면에서 드래그로 영역 선택
4. 신뢰도(Confidence) 조정 (0.5 ~ 1.0)
   - 높을수록 정확하지만 엄격함
   - 0.75 권장

### 색상 인식
1. **색상 대기** 액션 추가
2. **색상 선택** 버튼으로 화면에서 색상 선택
3. 허용 오차(Tolerance) 조정 (0 ~ 255)
   - 높을수록 비슷한 색상도 매칭

### 루프 (반복)
1. **루프** 액션 추가
2. 반복 횟수 설정
3. 루프 내부에 실행할 액션을 자식으로 추가
4. 재생 시 지정된 횟수만큼 반복 실행

### 조건 분기
1. **이미지 조건** 액션 추가
2. `children`: 이미지 발견 시 실행
3. `elseChildren`: 이미지 미발견 시 실행

## ⌨️ 단축키

| 단축키 | 기능 |
|--------|------|
| F9 | 녹화 시작/중지 |
| F12 | 긴급 중지 |
| Ctrl+S | 프로젝트 저장 |
| Ctrl+O | 프로젝트 열기 |
| Ctrl+N | 새 프로젝트 |
| Delete | 선택한 액션 삭제 |

## 💡 팁

### 1. 정확한 클릭 위치 지정
- 녹화 대신 **클릭** 액션을 수동으로 추가
- 우측 패널에서 **좌표 선택** 버튼 사용
- Space 키로 정확한 위치 선택

### 2. 한글 입력
- 기본적으로 클립보드를 통해 입력됨 (정확함)
- 빠른 입력이 필요하면 `use_clipboard: false` 설정

### 3. 재생 속도 조절
- 액션 사이에 **대기** 액션 추가
- 권장: 100~500ms (0.1~0.5초)

### 4. 실패 대응
- 이미지 인식이 실패하면 `retry_count` 설정
- `fallback_children`에 대체 액션 추가

### 5. 멀티모니터
- 좌표는 전체 화면 기준 (자동 계산됨)
- 이미지 인식은 전체 화면에서 검색
- `region` 파라미터로 특정 영역만 검색 가능

## ⚠️ 주의사항

1. **관리자 권한 필요** (전역 후킹)
2. **재생 중 긴급 중지**: F12 키 또는 마우스를 화면 좌상단으로 이동
3. **이미지 매칭 실패**: 신뢰도를 낮추거나 다중 스케일 활성화
4. **속도 이슈**: 대기 시간 조정, 불필요한 액션 제거

## 🔧 설정

**⚙️ 설정** 버튼에서:
- 테마: Light / Dark
- 언어: 한국어 / English
- 단축키 커스터마이징
- 알림 설정
- 기본 신뢰도/허용오차

## 📦 프로젝트 구조

```
~/.automacro/
├── projects/          # 저장된 프로젝트 (.json)
├── profiles/          # 프로파일 설정
├── settings.json      # 전역 설정
└── logs/              # 실행 로그
```

## 🆘 문제 해결

### 녹화가 안됨
- 관리자 권한으로 실행
- 안티바이러스 예외 추가

### 이미지 인식 실패
- 신뢰도 낮추기 (0.75 → 0.65)
- 다중 스케일 활성화
- 템플릿 이미지 재촬영

### 마우스 클릭이 안됨
- 좌표 확인 (모니터 설정 변경 시 달라질 수 있음)
- 절대 좌표 대신 이미지 인식 사용 권장

### 한글 입력 안됨
- `use_clipboard: true` 설정 확인
- pyperclip 설치 확인

## 🌟 예제

### 예제 1: 웹사이트 자동 로그인
```
1. 클릭 (ID 입력창) → 이미지 인식
2. 텍스트 입력 (ID)
3. 클릭 (PW 입력창) → 이미지 인식
4. 텍스트 입력 (PW)
5. 클릭 (로그인 버튼) → 이미지 인식
6. 대기 (2초)
```

### 예제 2: 반복 작업 (10회)
```
1. 루프 (count=10)
   ├─ 클릭 (작업 시작 버튼)
   ├─ 이미지 대기 (완료 표시, timeout=30s)
   ├─ 클릭 (다음 버튼)
   └─ 대기 (1초)
```

### 예제 3: 조건 분기
```
1. 이미지 조건 (에러 팝업)
   ├─ [발견 시] 클릭 (확인 버튼)
   └─ [미발견 시] 클릭 (계속 진행)
```
